;(node ntype (:p1 v1 :p2 v2) left right)
;macro: (barnode ntype (:p1 v1 :p2 v2) spec mod head bar)
;(morph ntype (:p1 v1 :p2 v2) root)
;(var ???)

(defvar *lang*)

(defun flatten (tree)
  (if (listp tree)
      (mapcan #'flatten tree)
    (list tree)))
(defun symb (&rest parts)
  (intern (format nil "狺疳螋螬┅ㄤ彐鲠灬礅溽怛徙脲舡戾鲥癌ㄤ彐躅怛徙脲舡灬礅溽蝈徜弪篝蝈犴汨狎ㄤ邈灬蝈ㄩ珙矧汨狎┅戾舄è灬礅溽怛徙脲舡戾鲥ū灬礅溽怛徙脲舡戾鲥飑ㄩ灬礅溽怛徙脲舡戾鲥暴н簌礅н灬礅溽怛徙脲舡戾鲥飑┅啜灬礅溽ì螬蝈徜溴扉黹翦洵扉篝＼篝蝈犴舂┅箦舡磲泸锃汨狎徙翦＼＇怛徙脲舡灬礅溽蝈徜弪箦舡磲泸锃汨狎徙翦＼ㄧ弭磲泸锃汨狎徙翦＼铋飑ㄤ彐磲泸戾舡珏簌眢怙澌怙澌啜戾磲疸狎垤轶唰ㄧ孱簌簌礅镬钺礤擤┹簌眢棱镤┅ㄤ彐磲泸铒溴铘疱狎珞蝈篝汨殪潋孱啜扉篝ь镤К铘疱狎珞楞栝熹蝈瞟ㄤ彐磲泸盹蝠铘疱狎珞蝻雉戾舡珏蝈屮轶趔痫屮轶趔暴戾è弪ㄦ矧磲铋⑼矧痂屙滹弩铒屮轶轭灬铉踽珏鏖翳疳螋镦箴邋汨幄蝻雉灬铉铘疱┅啜扉篝ы矧痂К铘疱眭祠轲戾鲠祯瀛忾钿ì痫屮轶趔暴ㄧ弭栳箬К铘疱ㄧ弭灬铉ъ屮殂镱┅ㄩ屮轶趔眭祠轲戾鲠祯瀛忾钿ì蝈屮轶趔博ㄧ弭栳箬К蝻雉痫螬ㄩ屮轶趔ㄡ痧孱扉篝泪蜱螬蝈螬ㄥ蝌矧弪颟┅ㄥ蝌矧弪颟┅┅┅ㄤ彐磲泸鲠钺礤蝈篝蝈耋啜扉篝鲠ㄩ铘弪簌礅镬钺礤钺礤щ妁黠蜾莉羼螬麸滹弪蝻汨邈腴铉ㄤ彐躅灬礅溟纟蝈篚祠趄邋啜灬礅溽é脲括蝈盹鲥殒埏铒簌礅镬擤ㄦ怙躅漯擤蝈盹鲥漉痨殂狒弩ㄦ灬趑孱趄邋┅犰祜鳝雉桢颦脲螬趄邋┅ㄤ彐磲泸忉箝悱蝓戾ㄦ矧蝈篚祠戾è箦ㄧ孱簌愆鲠蝮ㄧ孱簌愆磲翥ㄧ孱簌愆┅啜灬礅溽ì箦瞟眭祠轲戾鲠祯瀛忾钿ì鲠蝮磲翥瑭ㄧ弭鲠蝮箦骘蝽麒孱磲翥ㄡ痧禊灬礅溟纟蝈篚祠蝈篚祠鲠蝮┅┅┅ㄤ彐磲泸眭祠榄蝓戾é蝈篝灬弪螬戾舡珏ㄢ祀骖箦犰飙蝓戾蝓戾鲠蝮疳蝈铘鲠蝮啜灬礅溽ì箦瞟戾è犰飙蝓戾К磲疸狎垌狃汜垤轶ㄣ狎卟灬礅溟纟蝈篚祠矧ㄣ徜卟ㄣ狎卟┅┹咻灬弪螬┅ㄢ祜汶忪灬忮祗è骖ì蝓戾疳蝈铘鲠蝮ㄩ蝓戾祜镳骘ì颟轭ㄣ狎蝓戾螬殒ㄧ弭鲠蝮姗蝈趱蝾戾è鲠蝮轸┅箦翩ㄧ弭鲠蝮豪ì骖ㄧ弭鲠蝮豪ㄣ潋蝓戾螬┅ㄡ痧禊ㄡ痧孱鲠蝮疳蝈铘鲠蝮┅骈钺祆蝈趱蝾骝镯忪铋飑螬┅ì骖箦犰飙蝓戾铋飑┅┅┅ㄤ彐躅箦麴蝻铒溴痱镳鲠飑箦翩ㄧ弭ㄣ徜潋铒溴痱镳鲠飑铒溴轸痫篌殁戾翳狒翳轶鏖祆栳鲥躅轭翦钿邃箝溴彐驽泗殒箫徜泔瘗镳弪狒轱ㄤ彐躅泔瘗痱镳篁箴蝻溴篝镳糸镱犰漯蝻皓箦翩ㄧ弭ㄣ徜潋溴篝矧漯蝻箴蝻皓ㄧ弭ㄣ徜潋篁悌箴蝻皓溴篝ㄤ彐躅狃痨蝓戾蝓戾箦箦瞟灬忮祗è痱镤蹉扉篝螬ㄩ扉篝戾è蝈篝痱镤蹉ㄣ潋扉篝螬┅磲疸犷垌狃汜坫镱卟蝈篝ㄣ狎扉篝螬┅扉篝铋飑┅篝徵ㄩ瞽箦蝓戾螬戾èㄩㄡ钿扉篝轭箦瞟ㄥㄣ狎轭箦瞟ь镤濠磲疸狎坩痧孱篚怏羼轭箦畅咻痱镤蹉磲疸狎垠翎珏蝓戾筝ㄣ滗潋轭箦瞟┅扉篝轭箦瞟┅磲疸犷埏祜镳骘蝓戾轭蝓戾殒ㄦ躅汜祆蝓戾擤泔祆邈轸扉篝擤螬┅蝈漉沐灬礅溽颟磲疸犷垠翎珏蜉螬ㄣ镱扉篝箦瞟蝓戾箦舂┅ㄤ彐磲泸忉蝾镤瀛脲铘疱狎珞脲箴邈盹桢徜忉颟戾舄è钺礤簌礅镬钺礤铘疱┅ㄢ狍篚怏羼钺礤ū戾铉翳钺礤┅┅啜铒溴簌礅忉箦些狎珞箴邈铒溴簌礅忉箦ы镤铋盹铒溴簌礅忉箦р狎铋桢徜忉颟┅┅ㄤ彐磲泸忉蝾镤铘疱狎珞蝈篝疳螋螬啜忉蝾镤瀛脲铘疱狎珞括磲疸犷＇扉篝ㄥ祠Жīê桢徜ê桢徜衡狎ê箴邈鸿遽衡狎ê箴邈喉镤鸿遽衡狎┅戾铉翳疳螋螬疳螋螬┅ㄤ彐躅珏赧狎趄邋疳趑弪瞟灬忮祗è驷殪ī蝈趱蝾骝镯珏赧狎鲠祯弩铋铋飑┅ㄧ趄痿ㄣ镱è犷扉篝痿ㄥㄣ狎痿鲠颟扉篝ㄣ徜痿趄┅鲠蜷徕戾麸滹汨邈鲠蜷徕戾泔钿轸轱铙è矧铒扉篝趄┅铒扉篝痿┅躅戾篌ㄥ聃犰趄痿ㄦ衢飑┅è犷ㄥ豉疱镦ㄣ狎趄┅щ妁黠蜾铒痿┅屙痿扉篝磲翥栝铉狎珲礤铘è犷ㄥ豉疱镦ㄣ狎趄┅щ妁黠蜾ㄥ豉疱镦ㄣ狎痿┅щ妁黠蜾┅狎珈轶趔祜镳骘痱镳鲠飑镱痿怡＇沅潋狃疱钿轭ㄩ礤礅弪痱镳趄ㄧㄧ弭趄痱镳鲠飑ㄦ衢飑┅翳弪濮痱镡徕禊忮趑弪盹蝈彐骈汩孱舂麽麸滹翳轶犷麇ъ弼孱趱犰禊铄邃麸汨邈珈镡犰骘盹蝠桢礤痱镡徕禊è羼ㄣ狎趄ㄣ狎痿┅磲疸犷＇琏ㄣ潋趄ㄣ潋痿┅ㄦ衢飑┅┅鲠祯弩ㄧ趄邋疳趑弪瞟舂┅ㄤ彐躅灬铉踽珏簌铘狲灬铉踽珏蝈篝篝徵弩箦翩ㄧ弭灬铉踽珏簌铘狲篝徵弩┅ㄤ彐躅灬铉踽珏扉铄狎灬铉踽珏蝈篝篝徵弩箦翩ㄧ弭灬铉踽珏ъ轭遽颟篝徵弩┅ㄤ彐躅灬铉踽珏篚蜴徙灬铉踽珏蝈篝篝徵弩箦翩ㄧ弭灬铉踽珏篚蜴徙濠篝徵弩┅